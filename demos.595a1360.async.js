"use strict";(self.webpackChunkwumu_edit_table=self.webpackChunkwumu_edit_table||[]).push([[433],{99895:function(xt,Y,S){S.r(Y),S.d(Y,{default:function(){return vt}});var U=S(27424),m=S.n(U),h=S(67294),q=S(42122),v=S.n(q),l=S(85893);function tt(e){var t=e.columns,a=e.headerHeight,o=t.map(function(d,r){var n=d.title,s=d.dataIndex,i=d.align,c=i===void 0?"left":i,C={textAlign:c,borderRight:"1px solid #ccc"},f="".concat(s,"-").concat(r);return(0,l.jsxs)("th",{className:"table-th",style:C,children:[r,n]},f)}),u={height:a};return(0,l.jsx)("thead",{children:(0,l.jsx)("tr",{style:u,className:"table-header",children:o})})}var et=tt;function Z(e){return Array.isArray(e)?e:[]}function jt(e){return e!=null&&e!==""}var at=function(t){var a=t.initValue,o=t.inputChange,u=o===void 0?function(){}:o;return(0,l.jsx)("input",{className:"wumu-input",defaultValue:a,onChange:function(r){u(r.target.value)},autoFocus:!0})},nt=at;function ot(e){var t=e.columns,a=e.record,o=e.rowHeight,u=e.editId,d=e.onEdit,r=d===void 0?function(){}:d,n=e.handleChange,s=n===void 0?function(){}:n,i=a.rowKey;return(0,l.jsx)("tr",{className:"table-tr",children:t.map(function(c,C){var f=c.dataIndex,y="".concat(C,"-").concat(f),x="".concat(i,"-").concat(f),g=x===u,H={height:o,boxShadow:g?"inset 0px 0px 0px 1px var(--highlight-color)":""},p=function(j){s(j,{rowIndex:i,dataIndex:f,record:a,cellId:x})},w=a[f],A=g?(0,l.jsx)(nt,{initValue:w,inputChange:p,onEdit:r}):w;return(0,l.jsx)("td",{id:x,style:H,className:"table-td",onClick:function(){return typeof r=="function"?r(x):void 0},onBlur:function(){return r("")},children:A},y)})})}var rt=ot;function dt(e){var t=e.dataSource,a=e.columns,o=e.rowHeight,u=o===void 0?40:o,d=e.onEdit,r=e.editId,n=e.handleChange,s=n===void 0?function(){}:n,i=function(){};return Z(t).length===0?(0,l.jsxs)("div",{children:["\u6682\u65E0\u6570\u636E",(0,l.jsx)("button",{type:"button",onClick:function(){return i()},children:"\u65B0\u589E\u884C"})]}):(0,l.jsx)("tbody",{className:"table-tbody",children:Z(t).map(function(c){return rt({record:c,columns:a,rowHeight:u,onEdit:d,editId:r,handleChange:s})})})}var it=dt,lt=function(t,a){var o,u=a.overscan,d=u===void 0?0:u,r=a.itemHeight,n=r===void 0?40:r,s=a.maxHeight,i=a.height,c=i===void 0?510:i,C=a.onScrolled,f=C===void 0?function(){}:C,y=a.wrapperPropsStyle,x=y===void 0?{}:y,g=(0,h.useRef)(),H=(0,h.useState)(0),p=m()(H,2),w=p[0],A=p[1],I=(0,h.useState)((t==null?void 0:t.length)*n),j=m()(I,2),D=j[0],L=j[1],R=(0,h.useState)(Math.ceil(c/n)),P=m()(R,1),K=P[0],E=(0,h.useState)({}),T=m()(E,2),M=T[0],N=T[1],k=w*n,W=function(_){var V=_.target,$=V.scrollTop,X=$===void 0?0:$,J=V.scrollLeft,O=J===void 0?0:J;f({scrollLeft:O}),N(function(Ct){return v()(v()({},Ct),{},{scrollTop:X,scrollLeft:O})});var Q=d>0?Math.floor(X/n)-Math.ceil(d/2):Math.floor(X/n);A(Q>0?Q:0)},F={style:v()(v()({},x),{},{width:"100%",height:D,transform:"translateZ(0)",paddingTop:k})},G={onScroll:W,ref:function(_){return g.current=_},style:{overflowY:"overlay",overflowX:"auto",maxHeight:s,backgroundColor:"#fff",overflow:"auto"}};(0,h.useEffect)(function(){L((t==null?void 0:t.length)*n)},[t==null?void 0:t.length]),(0,h.useEffect)(function(){g!=null&&g.current&&N({offsetWidth:g.current.offsetWidth,clientWidth:g.current.clientWidth})},[g==null?void 0:g.current]);var b=t.slice(w,w+K+d);return{list:b,wrapperProps:F,containerProps:G,topHeight:k,bottomHeight:D-k-((o=b.length)!==null&&o!==void 0?o:0)*n,containerInfo:M}},ut=lt;function z(e){var t=e.columns,a=e.autoCol,o=e.scrollBar,u=a.autoWidthColIndex,d=a.autoColWidth,r=o?t.concat([{width:o}]):t;return(0,l.jsx)("colgroup",{children:r.map(function(n,s){var i=n.width,c="col-".concat(s);return u===s?(0,l.jsx)("col",{style:{width:d!=null?d:120}},c):(0,l.jsx)("col",{style:{width:i!=null?i:120}},c)})})}function st(e){var t=e.columns,a=e.clientWidth,o=a===void 0?0:a,u=null;t.forEach(function(r,n){var s=r.fixed;s!=="right"&&(u=n)});var d=o-1-t.reduce(function(r,n,s){var i;return r+(s===u?0:(i=n.width)!==null&&i!==void 0?i:120)},0);return{autoWidthColIndex:u,autoColWidth:d}}function ht(e){return e.map(function(t,a){return v()(v()({},t),{},{rowKey:a})})}function ct(){return 16}var gt=function(t){var a=t.columns,o=t.dataSource,u=t.editId,d=t.onEdit,r=d===void 0?function(){}:d,n=t.rowHeight,s=n===void 0?40:n,i=t.maxHeight,c=t.headerHeight,C=c===void 0?55:c,f=t.onChange,y=f===void 0?function(){}:f,x=(0,h.useRef)(),g=(0,h.useState)([]),H=m()(g,2),p=H[0],w=H[1],A=(0,h.useState)([]),I=m()(A,2),j=I[0],D=I[1],L=(0,h.useState)({autoWidthColIndex:null,autoColWidth:120}),R=m()(L,2),P=R[0],K=R[1],E=ut(p,{itemHeight:s,maxHeight:i,overscan:2,onScrolled:function(b){var B=b.scrollLeft;x.current&&(x.current.scrollLeft=B),r("")},wrapperPropsStyle:{borderSpacing:0,boxShadow:"inset 0px 0px 10px 0px #dadada"}}),T=E.list,M=E.wrapperProps,N=E.containerProps,k=E.bottomHeight,W=E.containerInfo,F=function(b,B){var _=B.rowIndex,V=B.dataIndex,$=p;$[_][V]=b,y($)};return(0,h.useEffect)(function(){(o==null?void 0:o.length)>0&&w(ht(o))},[o.length]),(0,h.useEffect)(function(){D(a)},[a]),(0,h.useLayoutEffect)(function(){W.clientWidth&&K(st({columns:j,clientWidth:W.clientWidth}))},[W]),(0,l.jsxs)("div",{className:"wumu-table",children:[(0,l.jsx)("div",{className:"wumu-table-header",ref:x,children:(0,l.jsxs)("table",{children:[z({columns:j,autoCol:P,scrollBar:ct()}),et({columns:j,headerHeight:C})]})}),(0,l.jsx)("div",v()(v()({className:"wumu-table-body"},N),{},{children:(0,l.jsxs)("table",v()(v()({},M),{},{children:[z({columns:j,autoCol:P}),it({dataSource:T,columns:j,rowHeight:s,onEdit:r,editId:u,handleChange:F}),(0,l.jsx)("div",{style:{height:k}})]}))}))]})},ft=gt,vt=function(){var e=(0,h.useState)(""),t=m()(e,2),a=t[0],o=t[1],u=[{title:"A",dataIndex:"A",width:300},{title:"B",dataIndex:"B"},{title:"C",dataIndex:"C",width:300},{title:"D",dataIndex:"D"},{title:"E",dataIndex:"E",width:380},{title:"F",dataIndex:"F",width:300}],d=[{A:"\u5E72\u561B",B:"\u54CE\u54DF",C:"haha",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"},{A:"fasdfasdf",B:"asdfasd",C:"ghjfgh"},{A:"adsfasdf",B:"fasdf",C:"rsfgsdf"},{A:"khjkghj",B:"\u54CE\u54DF",C:"8iuk",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"},{A:"wts",B:"vbn",C:"fhj"},{A:"fhjf",B:"\u54CE\u54DF",C:"haha",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"},{A:"\u5E72\u561B",B:"shshsdfgsdfgsdfgsdfgsdfgsdfg",C:"khjkghjk"},{A:"adsfads",B:"ghdfgjgh",C:"adsfasdfad"},{A:"adsfads",B:"ghdfgjgh",C:"adsfasdfad",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"},{A:"adsfads",B:"ghdfgjgh",C:"adsfasdfad",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"},{A:"fhjf",B:"\u54CE\u54DF",C:"haha",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"},{A:"adsfads",B:"ghdfgjgh",C:"adsfasdfad",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"},{A:"adsfads",B:"ghdfgjgh",C:"adsfasdfad",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"},{A:"fhjf",B:"\u54CE\u54DF",C:"haha",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"},{A:"adsfads",B:"ghdfgjgh",C:"adsfasdfad",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"},{A:"adsfads",B:"ghdfgjgh",C:"adsfasdfad"},{A:"fhjf",B:"\u54CE\u54DF",C:"haha",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"}],r=(0,h.useState)(d),n=m()(r,2),s=n[0],i=n[1];return(0,l.jsx)(ft,{editId:a,onEdit:o,columns:u,dataSource:s,maxHeight:320,onChange:function(C){return i(C)}})}}}]);
