"use strict";(self.webpackChunkwumu_edit_table=self.webpackChunkwumu_edit_table||[]).push([[433],{54226:function(wt,z,y){y.r(z),y.d(z,{default:function(){return jt}});var nt=y(27424),p=y.n(nt),g=y(67294),at=y(42122),x=y.n(at),d=y(85893);function ot(t){var e=t.columns,n=t.headerHeight,r=e.map(function(i,s){var l=i.title,a=i.dataIndex,o=i.align,h=o===void 0?"left":o,f={textAlign:h},v="".concat(a,"-").concat(s);return(0,d.jsx)("th",{title:l,className:"table-th",style:f,children:l},v)}),u={height:n};return(0,d.jsx)("thead",{children:(0,d.jsx)("tr",{style:u,className:"table-header",children:r})})}var dt=ot;function J(t){return Array.isArray(t)?t:[]}function St(t){return t!=null&&t!==""}var rt=function(e){var n=e.initValue,r=e.inputChange,u=r===void 0?function(){}:r,i=e.onEdit,s=i===void 0?function(){}:i,l=e.column,a=l.align,o=a===void 0?"left":a,h={textAlign:o};return(0,d.jsx)("input",{className:"wumu-input",style:h,defaultValue:n,onChange:function(v){u(v.target.value)},autoFocus:!0,onBlur:function(){return s("")}})},it=rt;function lt(t){var e=t.columns,n=t.record,r=t.rowHeight,u=t.editId,i=t.onEdit,s=i===void 0?function(){}:i,l=t.handleChange,a=l===void 0?function(){}:l,o=n._rowKey;return(0,d.jsx)("tr",{className:"table-tr",children:e.map(function(h,f){var v=h.dataIndex,j=h.align,w=j===void 0?"left":j,c=h.readonly,H=c===void 0?!1:c,b="".concat(f,"-").concat(v),C="".concat(o,"-").concat(v),S=C===u,L=function(){var m="table-td";return H&&(m+=" table-td-readonly"),m},B={height:r,textAlign:w,boxShadow:S?"inset 0px 0px 0px 1px var(--primary-color)":"",padding:S?" 0 8px":"0 12px"},$=function(m){a(m,{rowIndex:o,dataIndex:v,record:n,cellId:C})},_=n[v],W=S?(0,d.jsx)(it,{initValue:_,inputChange:$,onEdit:s,column:h}):_;return(0,d.jsx)("td",{id:C,style:B,className:L(),title:_,onClick:function(){return typeof s=="function"&&!H?s(C):void 0},children:W},b)})})}var ut=lt;function st(t){var e=t.dataSource,n=t.columns,r=t.rowHeight,u=r===void 0?40:r,i=t.onEdit,s=t.editId,l=t.handleChange,a=l===void 0?function(){}:l,o=t.notFoundContent,h=J(e).length===0;return h?o:(0,d.jsx)("tbody",{className:"table-tbody",children:J(e).map(function(f){return ut({record:f,columns:n,rowHeight:u,onEdit:i,editId:s,handleChange:a})})})}var ct=st,ht=function(e,n){var r,u,i=n.overscan,s=i===void 0?0:i,l=n.itemHeight,a=l===void 0?40:l,o=n.maxHeight,h=o===void 0?400:o,f=n.onScrolled,v=f===void 0?function(){}:f,j=n.wrapperPropsStyle,w=j===void 0?{}:j,c=(0,g.useRef)(null),H=(0,g.useState)(0),b=p()(H,2),C=b[0],S=b[1],L=(0,g.useState)(Math.ceil(h/a)),B=p()(L,1),$=B[0],_=(0,g.useState)({offsetWidth:0,clientWidth:0}),W=p()(_,2),A=W[0],m=W[1],k=C*a,D=(e==null?void 0:e.length)*a,R=function(P){var F=P.target,V=F.scrollTop,E=V===void 0?0:V,K=F.scrollLeft,M=K===void 0?0:K;v({scrollLeft:M}),m(function(N){return x()(x()({},N),{},{scrollTop:E,scrollLeft:M})});var G=s>0?Math.floor(E/a)-Math.ceil(s/2):Math.floor(E/a);S(G>0?G:0)},T={style:x()(x()({},w),{},{width:"100%",height:D,transform:"translateZ(0)",paddingTop:k})},U={onScroll:R,ref:function(P){return c.current=P},style:{overflowY:"overlay",overflowX:"auto",maxHeight:h,overflow:"auto"}};(0,g.useEffect)(function(){c!=null&&c.current&&m({offsetWidth:c.current.offsetWidth,clientWidth:c.current.clientWidth})},[c==null?void 0:c.current]);var I=e.slice(C,C+$+s);return console.log("bottomHeight",D,k,((r=I.length)!==null&&r!==void 0?r:0)*a),{list:I,wrapperProps:T,containerProps:U,topHeight:k,bottomHeight:D-k-((u=I.length)!==null&&u!==void 0?u:0)*a,containerInfo:A}},ft=ht;function Q(t){var e=t.columns,n=t.autoCol,r=t.scrollBar,u=n.autoWidthColIndex,i=n.autoColWidth,s=r?e.concat([{width:r}]):e;return(0,d.jsx)("colgroup",{children:s.map(function(l,a){var o=l.width,h="col-".concat(a);return u===a?(0,d.jsx)("col",{style:{width:i!=null?i:120}},h):(0,d.jsx)("col",{style:{width:o!=null?o:120}},h)})})}function gt(t){var e=t.columns,n=t.clientWidth,r=n===void 0?0:n,u=null;e.forEach(function(s,l){var a=s.fixed;a!=="right"&&(u=l)});var i=r-1-e.reduce(function(s,l,a){var o;return s+(a===u?0:(o=l.width)!==null&&o!==void 0?o:120)},0);return{autoWidthColIndex:u,autoColWidth:i}}function vt(t){return t.map(function(e,n){return x()(x()({},e),{},{_rowKey:n,rowIndex:n})})}function q(){return(0,d.jsx)("div",{className:"wumu-deafult-not-found-content",children:"\u6682\u65E0\u6570\u636E~"})}function tt(t){var e=t.containerInfo,n=t.children,r=n===void 0?q():n,u={width:e.offsetWidth,marginLeft:e.scrollLeft};return(0,d.jsx)("div",{children:(0,d.jsx)("div",{style:u,children:r})})}function mt(){return 16}var Ct=function(e){var n=e.columns,r=e.dataSource,u=e.editId,i=e.onEdit,s=i===void 0?function(){}:i,l=e.rowHeight,a=l===void 0?40:l,o=e.maxHeight,h=o===void 0?400:o,f=e.headerHeight,v=f===void 0?55:f,j=e.onChange,w=j===void 0?function(){}:j,c=e.hiddenHerder,H=c===void 0?!1:c,b=e.notFoundContent,C=b===void 0?null:b,S=(0,g.useRef)(null),L=(0,g.useState)([]),B=p()(L,2),$=B[0],_=B[1],W=(0,g.useState)([]),A=p()(W,2),m=A[0],k=A[1],D=(0,g.useState)({autoWidthColIndex:null,autoColWidth:120}),R=p()(D,2),T=R[0],U=R[1],I=ft($,{itemHeight:a,maxHeight:h,overscan:0,onScrolled:function(N){var O=N.scrollLeft;S.current&&(S.current.scrollLeft=O)},wrapperPropsStyle:{borderSpacing:0}}),X=I.list,P=I.wrapperProps,F=I.containerProps,V=I.bottomHeight,E=I.containerInfo,K=function(N,O){var Y=O.rowIndex,et=O.dataIndex,Z=$;Z[Y][et]=N,w(Z,{rowIndex:Y,dataIndex:et,value:N,record:Z[Y]})};(0,g.useEffect)(function(){console.log("process.env",{NODE_ENV:"production",PUBLIC_PATH:"/wumu-edit-table/"}),_(vt(r))},[r.length]),(0,g.useEffect)(function(){k(n)},[n]),(0,g.useLayoutEffect)(function(){E.clientWidth&&U(gt({columns:m,clientWidth:E.clientWidth}))},[E]);var M=H?null:(0,d.jsx)("div",{className:"wumu-table-header",ref:S,children:(0,d.jsxs)("table",{children:[Q({columns:m,autoCol:T,scrollBar:mt()}),dt({columns:m,headerHeight:v})]})});return(0,d.jsxs)("div",{className:"wumu-table",children:[M,(0,d.jsx)("div",x()(x()({className:"wumu-table-body"},F),{},{children:(0,d.jsxs)("table",x()(x()({},P),{},{children:[Q({columns:n,autoCol:T}),ct({dataSource:X,columns:m,rowHeight:a,onEdit:s,editId:u,handleChange:K,notFoundContent:tt(C?{containerInfo:E,children:C}:{containerInfo:E,children:q()})}),(0,d.jsx)("div",{style:{height:V}})]}))}))]})},xt=Ct,jt=function(){var t=(0,g.useState)(""),e=p()(t,2),n=e[0],r=e[1],u=[{title:"\u5E8F\u53F7",dataIndex:"rowIndex",width:60,align:"center"},{title:"A",dataIndex:"A",width:300},{title:"B",dataIndex:"B",align:"right"},{title:"C",dataIndex:"C",width:300},{title:"D",dataIndex:"D"},{title:"E",dataIndex:"E",width:380},{title:"F",dataIndex:"F",width:300}],i=[{A:"\u5E72\u561B",B:"\u54CE\u54DF",C:"haha",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"},{A:"fasdfasdf",B:"asdfasd",C:"ghjfgh"},{A:"adsfasdf",B:"fasdf",C:"rsfgsdf"},{A:"khjkghj",B:"\u54CE\u54DF",C:"8iuk",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"},{A:"wts",B:"vbn",C:"fhj"},{A:"fhjf",B:"\u54CE\u54DF",C:"haha",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"},{A:"\u5E72\u561B",B:"shshsdfgsdfgsdfgsdfgsdfgsdfg",C:"khjkghjk"},{A:"adsfads",B:"ghdfgjgh",C:"adsfasdfad"},{A:"adsfads",B:"ghdfgjgh",C:"adsfasdfad",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"},{A:"adsfads",B:"ghdfgjgh",C:"adsfasdfad",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"},{A:"fhjf",B:"\u54CE\u54DF",C:"haha",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"},{A:"adsfads",B:"ghdfgjgh",C:"adsfasdfad",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"},{A:"adsfads",B:"ghdfgjgh",C:"adsfasdfad",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"},{A:"fhjf",B:"\u54CE\u54DF",C:"haha",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"},{A:"adsfads",B:"ghdfgjgh",C:"adsfasdfad",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"},{A:"adsfads",B:"ghdfgjgh",C:"adsfasdfad"},{A:"fhjf",B:"\u54CE\u54DF",C:"haha",D:"\u5676\u901F\u5EA6\u8FDB\u6765\u770B\u54C8\u6D41\u53E3\u6C34\u7684\u4EFD",E:"guaiosdjlkgjasdgasdg"}],s=(0,g.useState)(i),l=p()(s,2),a=l[0],o=l[1],h=function(){o(function(c){return c.concat([{}])})},f=function(){o(function(c){return c.slice(0,-1)})},v=function(){o([])},j=function(c,H){console.log("options",H),o(c)};return(0,d.jsxs)("div",{className:"wumu-demo",children:[(0,d.jsxs)("div",{style:{display:"flex",marginBottom:"16px"},children:[(0,d.jsx)("button",{onClick:h,type:"button",className:"wumu-demo-button",children:"\u65B0\u589E\u4E00\u884C\u5230\u6700\u540E"}),(0,d.jsx)("button",{onClick:f,type:"button",className:"wumu-demo-button",children:"\u5220\u9664\u6700\u540E\u4E00\u884C"}),(0,d.jsx)("button",{onClick:v,type:"button",className:"wumu-demo-button",children:"\u5220\u9664\u6240\u6709\u6570\u636E"})]}),(0,d.jsx)(xt,{editId:n,onEdit:r,columns:u,dataSource:a,onChange:j})]})}}}]);
